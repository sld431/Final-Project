<html>
<head>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.5/p5.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.5/addons/p5.dom.js"></script>
	<script src="../lib/p5.speech.js"></script>
	<script>

	var myRec = new p5.SpeechRec('en-US', parseResult); // new P5.SpeechRec object
	myRec.continuous = true; // do continuous recognition
	myRec.interimResults = true; // allow partial recognition (faster, less accurate)

    var stillIRiseLines;
        
    var x, y;
    
    var imgB, imgDB, imgD;
    var imgD2, imgF, imgH;
    var imgH2, imgH3, imgK, imgL;
    var imgL2, imgO, imgP, imgR;
    var imgS, imgS2;
    var imgT, imgW; 
        

    function preload()
    {
        stillIRiseLines = loadStrings('StillIRise.txt');
        
        imgB = loadImage("broken.png");
        imgDB = loadImage("daybreak.jpg");
        imgD = loadImage("diamonds.jpg");
        imgD2 = loadImage("dirt.jpg");
        imgF = loadImage("fear.jpg");
        imgH = loadImage("history.png");
        imgH2 = loadImage("hopes.JPG");
        imgH3 = loadImage("huts.jpg");
        imgK = loadImage("kill.jpg");
        imgL = loadImage("laugh.jpg");
        imgL2 = loadImage("life.jpg");
        imgO = loadImage("ocean.jpg");
        imgP = loadImage("past.jpg");
        imgR = loadImage("rising.jpg");
        imgS = loadImage("sassiness.jpg");
        //imgS2 = loadImage("sexiness.png");
        imgT = loadImage("teardrops.jpg");
        imgW = loadImage("walk.jpg");
    }
        
	function setup()
	{
       // graphics stuff:
		createCanvas(1665, 955);
		background(232,28,28);
        noStroke();
        
        x = 20;
        y=height;

		// instructions:
		textSize(40);
		textAlign(LEFT);
        textFont('Futura', 'sans-script');
        
		//myRec.onResult = parseResult; // now in the constructor
		myRec.start(); // start engine
	}

	function draw()
	{
        background(232,28,28,0);
        
        fill(232,28,28);
        rect(0,0,windowWidth/2, windowHeight);
        
        noStroke();
        fill(0);
    
        //text(stillIRiseLines.length, 50, y);
            for (var i = 0; i < stillIRiseLines.length; i++) {
                fill(0);
                //fill(0+(i*3));
                text(stillIRiseLines[i], x, y+1*i*100);
                if(y>height){
                    y =0;
                    }
                }
        y = y-0.72;
	}

	function parseResult()
	{
		// recognition system will often append words into phrases.
		// so hack here is to only use the last word:
        fill(232,28,28,0.9);
		var mostrecentword = myRec.resultString.split(' ').pop();
		if(mostrecentword.indexOf("broken")!==-1) { image(imgB, 1159, 739, 149.61, 187.27); }
        else if(mostrecentword.indexOf("miraculously")!==-1) { image(imgDB, 994, 649, 155.35, 103.57); }
        else if(mostrecentword.indexOf("diamonds")!==-1) { image(imgD, 839, 765, 308.2, 161.8); }
        else if(mostrecentword.indexOf("lies")!==-1) { image(imgD2, 839, 11, 176.24, 117.49); }
        else if(mostrecentword.indexOf("fear")!==-1) { image(imgF, 1161, 583, 145.47,146.56); }
        else if(mostrecentword.indexOf("history")!==-1) { image(imgH, 1319, 642, 217.25, 284.69); }
        else if(mostrecentword.indexOf("hopes")!==-1) { image(imgH2, 1027, 11, 160.93, 286.06); }
        else if(mostrecentword.indexOf("dust")!==-1) { image(imgH3, 1198, 0, 106.35, 143.71); }
        else if(mostrecentword.indexOf("kill")!==-1) { image(imgK, 1315, 75, 221.38, 138.25); }
        else if(mostrecentword.indexOf("gold")!==-1) { image(imgL, 994, 489, 98.56, 148.42); }
        else if(mostrecentword.indexOf("ancestors")!==-1) { image(imgL2, 1319, 411, 125.41, 221.41); }
        else if(mostrecentword.indexOf("ocean")!==-1) { image(imgO, 1199, 150, 108.1, 146.42); }
        else if(mostrecentword.indexOf("past")!==-1) { image(imgP, 862, 140, 155.05, 157.01); }
        else if(mostrecentword.indexOf("sexy")!==-1) { image(imgR, 1101, 307, 205.94, 266.76); }
        else if(mostrecentword.indexOf("upset")!==-1) { image(imgS, 839, 308, 252.66, 168.88); }
        //else if(mostrecentword.indexOf("sexy")!==-1) { image(imgS2, random(835,1550), random(20,935), 270, 380); }
        else if(mostrecentword.indexOf("down")!==-1) { image(imgT, 1315, 224, 221.38, 177.13); }
        else if(mostrecentword.indexOf("oil")!==-1) { image(imgW, 839, 559, 145.02, 194.42); }
        else if(mostrecentword.indexOf("naturally")!==-1) { background(232, 28, 28); }
		console.log(mostrecentword);
	}

</script>
</head>
<body>
</body>
</html>
